{% extends 'base/layout.html' %}
{% load static %}

{% block title %}Prefix Validator{% endblock %}

{% block content %}
<div class="container mt-4">
  <h1>Prefix Validator</h1>
  <p class="text-muted">Compare prefixes between two VRFs to detect overlaps.</p>

  <form method="get" class="form-inline mb-4">
    <label for="integration_vrf" class="mr-2">Integration VRF:</label>
    <select name="integration_vrf" id="integration_vrf" class="form-control mr-4">
      <option value="">-- Select Integration VRF --</option>
      {% for vrf in vrfs %}
      <option value="{{ vrf.id }}" {% if vrf.id|stringformat:"s" == integration_vrf_id %}selected{% endif %}>
        {{ vrf.name }} ({{ vrf.rd }})
      </option>
      {% endfor %}
    </select>

    <label for="main_vrf" class="mr-2">Main VRF:</label>
    <select name="main_vrf" id="main_vrf" class="form-control mr-2">
      <option value="">-- Select Main VRF --</option>
      {% for vrf in vrfs %}
      <option value="{{ vrf.id }}" {% if vrf.id|stringformat:"s" == main_vrf_id %}selected{% endif %}>
        {{ vrf.name }} ({{ vrf.rd }})
      </option>
      {% endfor %}
    </select>

    <button type="submit" class="btn btn-primary">Validate</button>
  </form>

  {% if results %}
  <table class="table table-hover">
    <thead>
      <tr>
        <th>Prefix</th>
        <th>Message</th>
      </tr>
    </thead>
    <tbody>
      {% for row in results %}
      <tr class="table-{{ row.color }}">
        <td>{{ row.prefix }}</td>
        <td>{{ row.message|safe }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% elif integration_vrf_id and main_vrf_id %}
  <div class="alert alert-warning">No prefixes found in the selected Integration VRF.</div>
  {% endif %}
</div>
{% endblock %}
